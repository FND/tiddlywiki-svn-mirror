<html>
<head>



<script src="ieHack.js" type="text/javascript"></script>
<script src="canvasMaps3D.js" type="text/javascript"></script>

<script>
var eMap = null;
function init(){
	eMap = new EasyMap('wrapper');
	eMap.scale.x = 2.2;
	eMap.scale.y = 2.2;
	
	var that = eMap;
	var myElement = document.getElementById('caption');
	

	
	function highlight(shape){
		that.oldcolor = shape.fillStyle;
		that.oldstrokecolor = shape.strokeStyle;
		shape.fillStyle = "#FFFFFF";
		shape.strokeStyle = "#FFFFFF";
		var el = myElement;
		if(el.style.display == 'none'){
			el.style.position = "absolute";
			el.style.display = "";
			var legal = "";
			if(shape.properties.legality == 1) legal = " (legal)";
			else if(shape.properties.legality == 0) legal = "(illegal)";
			else legal = "(no data)";
			el.innerHTML = shape.tooltip + legal;
			el.style.left =0;
			el.style.top = 300;

		}	
		that.redrawShape(shape);
	}
	
	function dehighlight(shape){
		if(!shape) return;
		if(that.oldcolor)shape.fillStyle = that.oldcolor;
		if(that.oldstrokecolor)shape.strokeStyle = that.oldstrokecolor;
		that.redrawShape(shape);
		myElement.style.display = "none";
	}
	
	var shapeHighlighted;
	eMap.mousemoveHandler = function(e){
		try{
		var t1 = new Date();
		var shape = eMap.getShapeAt(e);
		var t2 = new Date();
		var time = t2-t1;
	
		if(!shape) {
			dehighlight(shapeHighlighted);
			shapeHighlighted = null;
			return;
		}
		
		if(shapeHighlighted) dehighlight(shapeHighlighted);
			highlight(shape);
			shapeHighlighted = shape;
		}
		catch(e){
			document.getElementById('time').innerHTML += e + ",";
		}

	};
	eMap.mousemoveHandler = function(e){
			var ll = eMap.getLongLatAt(e);
			document.getElementById('time').innerHTML ="long: " + ll.longitude + " lat:" + ll.latitude + "<br>";
			
			var shape =eMap.getShapeAt(e);
			
			if(shape)
			document.getElementById('time').innerHTML +="long: " + shape.longitudes + " lat:" + shape.latitudes;			
	};

	eMap.clickHandler = function(e){

		var s = eMap.getShapeAt(e);

		
		if(s)
			alert(s.tooltip);
	};
	
	eMap.drawFromGeojsonFile('whereLegal.json');
	eMap.addControl("pan");
	
	var spin = function() {
			eMap.spin(0.01,0,0);
			window.setTimeout(spin,100);
		}
		spin();

}

</script>
</head>

<body onload="window.setTimeout(init,0)">
<h1>Countries where homosexual acts are legal/illegal</h1>

spin: <a href="javascript:eMap.spin(-0.5,0,0)"><--</a><a href="javascript:eMap.spin(0.5,0,0)">--></a>
<a href="javascript:eMap.spin(0,-0.5,0)">up</a> <a href="javascript:eMap.spin(0,0.5,0)">down</a>
<div id='wrapper' style="width:800; height:400;position:relative;">
	<div id ='caption'></div>
	<div id='wrapper_statustext'>please wait while we load... </div>
</div>
<div id='time'></div>
<a href="javascript:eMap.zoom(0.5,0.5)">zoom in</a> <a href="javascript:eMap.zoom(-0.5,-0.5)">zoom out</a>


<a href="javascript:eMap.pan(0,20)">up</a> <a href="javascript:eMap.pan(0,-20)">down</a>

<a href="javascript:eMap.pan(20,0)">left</a> <a href="javascript:eMap.pan(-20,0)">right</a>







</body>
</html>