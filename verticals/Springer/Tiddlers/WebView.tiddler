<div tiddler="WebView" modifier="ESpringer" modified="200602040109" created="200602040109" tags="plugins excludeLists excludeSearch">\n// //''Code section:''\n// //Webview settings (edit the following with true (enable) or false (disable) according to how the page should look from the web)\nvar wvShowNewTiddler = false; // //''affects all &quot;new tidder&quot; macro links''\nvar wvShowNewJournal = false; // //''affects all &quot;new journal&quot; macro links''\nvar wvDblClickToEdit = false; // //''enables/disables the &quot;double-click to edit a tiddler&quot; feature''\nvar wvShowClose = true; // //''show/hide toolbar close buttons''\nvar wvShowEdit = false; // //''show/hide toolbar edit buttons''\nvar wvShowPermalink = false; // //''show/hide toolbar permalink buttons''\nvar wvShowReferences = false; // //''show/hide toolbar references buttons''\nvar wvShowTags = false; // //''show/hide tiddler tag footers''\nvar wvShowTabs = true; // //''show/hide sidebar tabs entirely (you can also customize them below)''\n\n// //Alternate versions of SideBar, Options, AdvancedOptions, SideBarTabs, and MoreTab\nconfig.shadowTiddlers.wvSideBarOptions = &quot;&quot;;\n\nconfig.shadowTiddlers.wvOptionsPanel = &quot;&quot;;\n\nconfig.shadowTiddlers.wvSideBarTabs = &quot;&lt;&lt;tabs txtMainTab Recent Timeline TabTimeline Index 'All tiddlers' TabAll&gt;&gt;&quot;;\n\nconfig.shadowTiddlers.wvTabMore = &quot;&lt;&lt;tabs txtMoreTab Tags 'All tags' TabTags Missing 'Missing tiddlers' TabMoreMissing Orphans 'Orphaned tiddlers' TabMoreOrphans&gt;&gt;&quot;;\n\n\n// //''Actual code section (no need to edit below this line for most users)''\n// //------------------------------------------------------------------------------\nversion.extensions.webview = {major: 0, minor: 1, revision: 1, date: new Date(2005,8,10)};\n// Identify special tiddlers to intercept\nvar wvShadowTiddlers = [&quot;SideBarOptions&quot;,&quot;OptionsPanel&quot;,&quot;AdvancedOptions&quot;,&quot;SideBarTabs&quot;,&quot;TabMore&quot;];\n\n// Determine if the page is being loaded locally or from the web\nvar docPath = document.location.toString().substring(0,document.location.toString().indexOf(&quot;:&quot;));\nif(docPath == &quot;file&quot;)\n      var inWebView = false;\nelse\n     var inWebView = true;\n\n// Hijack the newTiddler function\nconfig.macros.newTiddler.handler_orig_webView = config.macros.newTiddler.handler;\nconfig.macros.newTiddler.handler = function(place,macroName,params)\n{\n     if (!inWebView || wvShowNewTiddler)\n             config.macros.newTiddler.handler_orig_webView(place,macroName,params);\n}\n\n// Hijack the newJournal function\nconfig.macros.newJournal.handler_orig_webView = config.macros.newJournal.handler;\nconfig.macros.newJournal.handler = function(place,macroName,params)\n{\n        if (!inWebView || wvShowNewJournal)\n             config.macros.newJournal.handler_orig_webView(place,macroName,params);\n}\n\n// Replace &quot;double-click to edit&quot; function\nwindow.onDblClickTiddler_orig_webView = window.onDblClickTiddler;\nwindow.onDblClickTiddler = function(e) {\nif(!inWebView || wvDblClickToEdit)\n    {\n        clearMessage();\n        if(document.selection)\n                document.selection.empty();\n        var tiddler;\n       if(this.id.substr(0,7) == &quot;tiddler&quot;)\n              tiddler = this.id.substr(7);\n      if(tiddler)\n                displayTiddler(null,tiddler,2,null,null,false,false);\n        }\n}\n\n// Hijack the createTiddlerToolbar function\nwindow.createTiddlerToolbar_orig_webView = window.createTiddlerToolbar;\nwindow.createTiddlerToolbar = function(title,isEditor)\n{\n        var theToolbar = document.getElementById(&quot;toolbar&quot; + title);\n   var lingo = config.views;\n     if(theToolbar)\n                {\n                removeChildren(theToolbar);\n                insertSpacer(theToolbar);\n                if(isEditor)\n                        {\n                        // Editor toolbar\n                      lingo = lingo.editor;\n                      createTiddlyButton(theToolbar,lingo.toolbarDone.text,lingo.toolbarDone.tooltip,onClickToolbarSave);\n                        insertSpacer(theToolbar);\n                        createTiddlyButton(theToolbar,lingo.toolbarCancel.text,lingo.toolbarCancel.tooltip,onClickToolbarUndo);\n                        insertSpacer(theToolbar);\n                        createTiddlyButton(theToolbar,lingo.toolbarDelete.text,lingo.toolbarDelete.tooltip,onClickToolbarDelete);\n                        }\n                else\n                        {\n                        // Viewer toolbar\n                      lingo = lingo.wikified;\n                      if(!inWebView || wvShowClose)\n                              {\n                                createTiddlyButton(theToolbar,lingo.toolbarClose.text,lingo.toolbarClose.tooltip,onClickToolbarClose);\n                                insertSpacer(theToolbar);\n                                }\n                        if(!inWebView || wvShowEdit)\n                              {\n                                createTiddlyButton(theToolbar,lingo.toolbarEdit.text,lingo.toolbarEdit.tooltip,onClickToolbarEdit);\n                                insertSpacer(theToolbar);\n                                }\n                        if(!inWebView || wvShowPermalink)\n                              {\n                                createTiddlyButton(theToolbar,lingo.toolbarPermalink.text,lingo.toolbarPermalink.tooltip,onClickToolbarPermaLink);\n                                insertSpacer(theToolbar);\n                                }\n                        if(!inWebView || wvShowReferences)\n                              {\n                                createTiddlyButton(theToolbar,lingo.toolbarReferences.text,lingo.toolbarReferences.tooltip,onClickToolbarReferences);\n                                }\n                        }\n                insertSpacer(theToolbar);\n                }\n}\n\n// Hijack the createTiddlerFooter function\nwindow.createTiddlerFooter_orig_webView = window.createTiddlerFooter;\nwindow.createTiddlerFooter = function(title,isEditor)\n{\n        if(!inWebView || wvShowTags)\n              createTiddlerFooter_orig_webView(title,isEditor);\n}\n\n// sideBar, options, and tab settings code\n// Hijack the getTiddlerText prototype function\nTiddlyWiki.prototype.getTiddlerText_orig_webView = TiddlyWiki.prototype.getTiddlerText;\nTiddlyWiki.prototype.getTiddlerText = function(title,defaultText)\n{\n if(inWebView &amp;&amp; (wvShadowTiddlers.join(&quot;~&quot;).match(title) == title))\n            {\n                defaultText = store.getTiddlerText_orig_webView(title,defaultText);\n              var tiddlerText = store.getTiddlerText_orig_webView(&quot;wv&quot;+title,defaultText);\n             }\n        else\n                var tiddlerText = store.getTiddlerText_orig_webView(title,defaultText);\n     return tiddlerText;\n}\n// Reset the getTiddlerText function for the current store\nstore.getTiddlerText = TiddlyWiki.prototype.getTiddlerText;\n// SideBarTabs show/hide code\n// Remove the old refreshTabs function from notifyTiddlers &amp; store notifications\nfor(t=0; t&lt;config.notifyTiddlers.length; t++)\n      if(config.notifyTiddlers[t] == window.refreshTabs)\n              config.notifyTiddlers.splice(t,1);\n// Hijack the refreshTabs function\nwindow.refreshTabs_orig_webView = window.refreshTabs;\nwindow.refreshTabs = function(hint)\n{\n        if(!inWebView || wvShowTabs)\n              refreshTabs_orig_webView(hint);\n        else\n                document.getElementById(&quot;sidebarTabs&quot;).style.display = &quot;none&quot;;\n}\n// Add our new refreshTabs function to the notifyTiddlers list &amp; store notifications\nconfig.notifyTiddlers.push(refreshTabs());\nstore.addNotification(null,refreshTabs);\n</div>