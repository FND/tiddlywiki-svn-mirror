<?php


set_include_path(get_include_path() . PATH_SEPARATOR . './PEAR/');
require_once 'Testing/Selenium.php';
require_once 'PHPUnit/Framework/TestCase.php';

class loginTest extends PHPUnit_Framework_TestCase
{
    private $selenium;

    public function setUp()
    {
        $this->selenium = new Testing_Selenium("*iexplore", "http://127.0.0.1");
        $this->selenium->start();

    }

    public function testLogin()
    {
        $this->selenium->open("/Trunk");

	 $this->selenium->deleteAllVisibleCookies();


  	$this->selenium->type("username", "username");
  	$this->selenium->type("password", "password");
  	$this->selenium->click("link=Login");
        $this->selenium->waitForPageToLoad(1000);
	$this->selenium->click("backstageShow");

        $this->selenium->waitForPageToLoad(1000);	
	$this->selenium->click("backstageShow");
   	 try {
    	    $this->assertTrue($this->selenium->isTextPresent("logout?"));
    	} catch (PHPUnit_Framework_AssertionFailedError $e) {
		echo "<div style='background-color:red'><h1>Error</h1>";
		print_r($e);
		mail("mcmanus.simon@gmail.com", "bug detected", print_r($e));
	echo "</div>";

    }

    }

}


$t = new loginTest();
$t->setUp();
$t->testLogin();
?>
